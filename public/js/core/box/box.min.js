define(function(require,exports,module){"use strict";var t='<div class="js-box"><div class="js-box-t"><h4 class="js-box-t-title"></h4><a href="javascript:;" class="js-box-t-close">关闭</a></div><div class="js-box-c"></div><div class="js-box-b"><a href="javascript:;" class="js-box-b-ok"><span>确定</span></a><a href="javascript:;" class="js-box-b-cancel"><span>取消</span></a></div></div>',o={boxid:"js-box",boxclass:"js-box",title:"",width:0,height:0,showTitle:!0,showButton:!0,showOk:!0,showCancel:!0,okBtnName:"确定",cancelBtnName:"取消",timeout:0,showmask:!0,mask:{bgcolor:"#000000",opacity:.1,zIndex:null},zIndex:500,remember:!1,position:"center",clickOut:null,onclose:null,onopen:null,oncancel:null,onok:null,blur:null,focus:null,autoHeight:!0,autoPosition:!0};module.exports=function(i,s){var n=$(window),h=$(document),e=$("body"),c={};c={content:i,winWidth:null,winHeight:null,options:$.extend({},o,s),maskopt:$.extend({},o.mask,s.mask),init:function(){this.options.showmask&&this.initMask(),this.initBox(),this.renderBox(),this.setContent(),this._box.appendTo(e),this.setPosition(),this.options.onopen&&this.options.onopen(this),this.bind()},initMask:function(){$(".js-mask")[0]||(this._mask=$('<div class="js-mask"></div>'),this.maskopt.zIndex?this._mask.css("z-index",this.maskopt.zIndex):this._mask.css("z-index",this.options.zIndex-10),this._mask.css("background-color",this.maskopt.bgcolor),this._mask.css("opacity",this.maskopt.opacity),this._mask.css(this.getBody()),this._mask.appendTo(e))},initBox:function(){this._box=$(t).css({zIndex:this.options.zIndex}),this._t_title=this._box.find(".js-box-t-title"),this._t_close=this._box.find(".js-box-t-close"),this._b_content=this._box.find(".js-box-c"),this._b_button=this._box.find(".js-box-b"),this._b_ok=this._box.find(".js-box-b-ok"),this._b_cancel=this._box.find(".js-box-b-cancel"),this._box.attr("id",this.options.boxid)},renderBox:function(){this.options.showTitle?this._t_title.show():this._t_title.hide(),this.options.title?this._t_title.html(this.options.title):this._t_title.empty(),this.options.showButton?this._b_button.show():this._b_button.hide(),this.options.showOk?this._b_button.find(".js-box-b-ok").show():this._b_button.find(".js-box-b-ok").hide(),this.options.okBtnName?this._b_button.find(".js-box-b-ok").html(this.options.okBtnName):this._b_button.find(".js-box-b-ok").empty(),this.options.showCancel?this._b_button.find(".js-box-b-cancel").show():this._b_button.find(".js-box-b-cancel").hide(),this.options.cancelBtnName?this._b_button.find(".js-box-b-cancel").html(this.options.cancelBtnName):this._b_button.find(".js-box-b-cancel").empty()},setContent:function(){"undefined"!=typeof this.content&&null!==i&&(this._b_content.html(this.content),this.options.width>0?this._box.css("width",this.options.width):this._box.css("width","auto"),this.options.height>0&&(this._b_content.css("height",this.options.height),this._b_content.css("overflow-y","scroll")),this.options.autoHeight&&this._b_content.css("height","auto"))},setPosition:function(){var t=this._box.width(),o=this._box.height();this._box.css({marginTop:0-o/2,marginLeft:0-t/2})},bind:function(){this._t_close.on("click",function(){c.options.onclose&&c.options.onclose(c),c.remove()}),this._b_cancel.on("click",function(){c.options.oncancel&&c.options.oncancel(c),c.remove()}),this._b_ok.on("click",function(){c.options.onok&&c.options.onok(c),c.remove()}),this._box.bind("click",function(){c._onbox=!0}),h.bind("click",function(t){return 0!==t.button?!0:(!c._onbox&&c.options.clickOut&&c.options.clickOut(c),void(c._onbox=!1))}),this.options.timeout>0&&setTimeout(this.remove,this.options.timeout),this.options.focus&&$(this.options.focus).focus(),this.options.autoPosition&&this._box.height()<n.height()&&this._box.css("position","fixed")},getWin:function(){this.winWidth=n.width(),this.winHeight=n.height()},getBody:function(){return{width:e.width(),height:e.height()}},remove:function(){this._mask&&this._mask.remove(),this._box.remove(),this.options.blur&&$(this.options.blur).focus()}},c.init()}});